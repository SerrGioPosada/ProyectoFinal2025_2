<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<ScrollPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="co.edu.uniquindio.poo.proyectofinal2025_2.Controller.AdminDashboardController"
            styleClass="scroll-base"
            stylesheets="@../Style.css"
            fitToWidth="true">

    <VBox spacing="15" styleClass="content-area">

        <!-- Header Section - More Compact -->
        <HBox alignment="CENTER_LEFT" spacing="20" styleClass="header-section" style="-fx-padding: 15;">
            <VBox spacing="3" HBox.hgrow="ALWAYS">
                <Label text="Panel de Control" styleClass="dashboard-title"/>
                <Label fx:id="lblLastUpdated" text="Última actualización: --" styleClass="info-label"/>
            </VBox>
            <Button text="Actualizar" onAction="#handleRefresh" styleClass="btn-primary"/>
        </HBox>

        <!-- Compact Statistics Overview -->
        <GridPane hgap="10" vgap="10">
            <columnConstraints>
                <ColumnConstraints percentWidth="16.66"/>
                <ColumnConstraints percentWidth="16.66"/>
                <ColumnConstraints percentWidth="16.66"/>
                <ColumnConstraints percentWidth="16.66"/>
                <ColumnConstraints percentWidth="16.66"/>
                <ColumnConstraints percentWidth="16.66"/>
            </columnConstraints>

            <!-- Total Users -->
            <VBox styleClass="stat-card-compact" spacing="5" GridPane.columnIndex="0">
                <Label text="Usuarios" styleClass="stat-label-compact"/>
                <Label fx:id="lblTotalUsers" text="0" styleClass="stat-value-compact"/>
            </VBox>

            <!-- Total Shipments -->
            <VBox styleClass="stat-card-compact" spacing="5" GridPane.columnIndex="1">
                <Label text="Envíos" styleClass="stat-label-compact"/>
                <Label fx:id="lblTotalShipments" text="0" styleClass="stat-value-compact"/>
            </VBox>

            <!-- Delivered -->
            <VBox styleClass="stat-card-compact-success" spacing="5" GridPane.columnIndex="2">
                <Label text="Entregados" styleClass="stat-label-compact"/>
                <Label fx:id="lblDeliveredShipments" text="0" styleClass="stat-value-compact"/>
            </VBox>

            <!-- In Transit -->
            <VBox styleClass="stat-card-compact-info" spacing="5" GridPane.columnIndex="3">
                <Label text="En Tránsito" styleClass="stat-label-compact"/>
                <Label fx:id="lblInTransitShipments" text="0" styleClass="stat-value-compact"/>
            </VBox>

            <!-- Total Revenue -->
            <VBox styleClass="stat-card-compact-warning" spacing="5" GridPane.columnIndex="4">
                <Label text="Ingresos" styleClass="stat-label-compact"/>
                <Label fx:id="lblTotalRevenue" text="0" styleClass="stat-value-compact"/>
            </VBox>

            <!-- Success Rate -->
            <VBox styleClass="stat-card-compact-primary" spacing="5" GridPane.columnIndex="5">
                <Label text="Éxito" styleClass="stat-label-compact"/>
                <Label fx:id="lblDeliverySuccessRate" text="0" styleClass="stat-value-compact"/>
            </VBox>
        </GridPane>

        <!-- Main Charts Section - FULL WIDTH, LARGE -->
        <Label text="Gráficas y Análisis" styleClass="section-title" style="-fx-font-size: 20; -fx-padding: 10 0 5 0;"/>

        <!-- Row 1: Status Distribution and Trends (LARGE) -->
        <HBox spacing="15" prefHeight="500">
            <!-- Shipment Status Pie Chart - LARGE -->
            <VBox styleClass="chart-container-large" spacing="8" HBox.hgrow="ALWAYS" prefHeight="500">
                <Label text="Distribución de Envíos por Estado" styleClass="chart-title-large"/>
                <PieChart fx:id="chartShipmentStatus"
                         legendVisible="true"
                         labelsVisible="true"
                         VBox.vgrow="ALWAYS"
                         prefHeight="450"/>
            </VBox>

            <!-- Shipments Trend Area Chart - LARGE -->
            <VBox styleClass="chart-container-large" spacing="8" HBox.hgrow="ALWAYS" prefHeight="500">
                <Label text="Tendencia de Envíos (Últimos 7 Días)" styleClass="chart-title-large"/>
                <AreaChart fx:id="chartShipmentsTrend"
                          legendVisible="false"
                          createSymbols="false"
                          VBox.vgrow="ALWAYS"
                          prefHeight="450">
                    <xAxis>
                        <CategoryAxis side="BOTTOM"/>
                    </xAxis>
                    <yAxis>
                        <NumberAxis label="Cantidad" side="LEFT"/>
                    </yAxis>
                </AreaChart>
            </VBox>
        </HBox>

        <!-- Row 2: Revenue and Performance (LARGE) -->
        <HBox spacing="15" prefHeight="500">
            <!-- Revenue Trend Line Chart - LARGE -->
            <VBox styleClass="chart-container-large" spacing="8" HBox.hgrow="ALWAYS" prefHeight="500">
                <Label text="Tendencia de Ingresos (Últimos 7 Días)" styleClass="chart-title-large"/>
                <LineChart fx:id="chartRevenueTrend"
                          legendVisible="false"
                          createSymbols="true"
                          VBox.vgrow="ALWAYS"
                          prefHeight="450">
                    <xAxis>
                        <CategoryAxis side="BOTTOM"/>
                    </xAxis>
                    <yAxis>
                        <NumberAxis label="Ingresos ($)" side="LEFT"/>
                    </yAxis>
                </LineChart>
            </VBox>

            <!-- Delivery Person Performance Bar Chart - LARGE -->
            <VBox styleClass="chart-container-large" spacing="8" HBox.hgrow="ALWAYS" prefHeight="500">
                <Label text="Rendimiento de Repartidores" styleClass="chart-title-large"/>
                <BarChart fx:id="chartDeliveryPersonPerformance"
                         legendVisible="false"
                         VBox.vgrow="ALWAYS"
                         prefHeight="450">
                    <xAxis>
                        <CategoryAxis side="BOTTOM"/>
                    </xAxis>
                    <yAxis>
                        <NumberAxis label="Envíos" side="LEFT"/>
                    </yAxis>
                </BarChart>
            </VBox>
        </HBox>

        <!-- Row 3: Incidents (Full Width, LARGE) -->
        <VBox styleClass="chart-container-large" spacing="8" prefHeight="450">
            <Label text="Distribución de Incidentes por Tipo" styleClass="chart-title-large"/>
            <PieChart fx:id="chartIncidentsByType"
                     legendVisible="true"
                     labelsVisible="true"
                     VBox.vgrow="ALWAYS"
                     prefHeight="400"/>
        </VBox>

        <!-- Footer Spacing -->
        <Region prefHeight="30"/>

    </VBox>
</ScrollPane>
