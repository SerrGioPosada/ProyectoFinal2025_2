<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<AnchorPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="co.edu.uniquindio.poo.ProyectoFinal2025_2.Controller.PaymentController"
            prefHeight="650.0" prefWidth="700.0"
            styleClass="root-pane">

    <ScrollPane fitToWidth="true" fitToHeight="true"
                styleClass="details-scroll"
                AnchorPane.topAnchor="0" AnchorPane.bottomAnchor="0"
                AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0">

        <VBox spacing="20" styleClass="details-container">
            <padding>
                <Insets top="30" right="40" bottom="30" left="40"/>
            </padding>

            <!-- Header -->
            <VBox spacing="10" styleClass="header-section">
                <Label text="Procesamiento de Pago" styleClass="section-title"/>
                <HBox spacing="20">
                    <Label fx:id="lblOrderId" text="Orden #" styleClass="detail-value"/>
                    <Label fx:id="lblInvoiceId" text="Factura #" styleClass="detail-value"/>
                </HBox>
                <Label fx:id="lblTotalAmount" text="$0 COP" styleClass="total-value"/>
            </VBox>

            <Separator/>

            <!-- Payment Method Selection -->
            <VBox spacing="15" styleClass="detail-section">
                <Label text="Método de Pago" styleClass="section-title"/>

                <VBox spacing="10">
                    <RadioButton fx:id="rbCreditCard" text="Tarjeta de Crédito"
                                 styleClass="form-checkbox"/>
                    <RadioButton fx:id="rbDebitCard" text="Tarjeta de Débito"
                                 styleClass="form-checkbox"/>
                    <RadioButton fx:id="rbMercadoPago" text="Mercado Pago"
                                 styleClass="form-checkbox"/>
                    <RadioButton fx:id="rbCash" text="Efectivo (Contra Entrega)"
                                 styleClass="form-checkbox"/>
                </VBox>
            </VBox>

            <Separator/>

            <!-- Card Details Section -->
            <VBox fx:id="vboxCardDetails" spacing="15" styleClass="detail-section"
                  visible="false" managed="false">
                <Label text="Detalles de la Tarjeta" styleClass="section-title"/>

                <GridPane hgap="15" vgap="15">
                    <columnConstraints>
                        <ColumnConstraints hgrow="ALWAYS" minWidth="150"/>
                        <ColumnConstraints hgrow="ALWAYS" minWidth="150"/>
                    </columnConstraints>

                    <!-- Card Number -->
                    <VBox spacing="5" GridPane.columnIndex="0" GridPane.columnSpan="2" GridPane.rowIndex="0">
                        <Label text="Número de Tarjeta" styleClass="form-label"/>
                        <TextField fx:id="txtCardNumber" promptText="1234 5678 9012 3456"
                                   styleClass="form-field" maxWidth="Infinity"/>
                    </VBox>

                    <!-- Card Holder -->
                    <VBox spacing="5" GridPane.columnIndex="0" GridPane.columnSpan="2" GridPane.rowIndex="1">
                        <Label text="Titular de la Tarjeta" styleClass="form-label"/>
                        <TextField fx:id="txtCardHolder" promptText="Nombre como aparece en la tarjeta"
                                   styleClass="form-field" maxWidth="Infinity"/>
                    </VBox>

                    <!-- Card Provider -->
                    <VBox spacing="5" GridPane.columnIndex="0" GridPane.columnSpan="2" GridPane.rowIndex="2">
                        <Label text="Emisor de la Tarjeta" styleClass="form-label"/>
                        <ComboBox fx:id="cmbCardProvider" styleClass="form-combo"
                                  maxWidth="Infinity" promptText="Seleccionar emisor"/>
                    </VBox>

                    <!-- Expiry Date -->
                    <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="3">
                        <Label text="Mes de Vencimiento" styleClass="form-label"/>
                        <TextField fx:id="txtExpiryMonth" promptText="MM"
                                   styleClass="form-field"/>
                    </VBox>

                    <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="3">
                        <Label text="Año de Vencimiento" styleClass="form-label"/>
                        <TextField fx:id="txtExpiryYear" promptText="AAAA"
                                   styleClass="form-field"/>
                    </VBox>

                    <!-- CVV -->
                    <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="4">
                        <Label text="CVV" styleClass="form-label"/>
                        <TextField fx:id="txtCVV" promptText="123"
                                   styleClass="form-field"/>
                    </VBox>
                </GridPane>
            </VBox>

            <!-- Mercado Pago Section -->
            <VBox fx:id="vboxMercadoPago" spacing="15" styleClass="detail-section"
                  visible="false" managed="false">
                <Label text="Pago con Mercado Pago" styleClass="section-title"/>

                <VBox spacing="10" styleClass="info-box">
                    <Label fx:id="lblMercadoPagoInstructions"
                           text="Será redirigido a Mercado Pago para completar el pago de forma segura."
                           styleClass="detail-value" wrapText="true"/>
                    <Button fx:id="btnOpenMercadoPago" text="Abrir Mercado Pago"
                            onAction="#handleOpenMercadoPago"
                            styleClass="btn-info" prefHeight="40"/>
                </VBox>
            </VBox>

            <!-- Cash Payment Section -->
            <VBox fx:id="vboxCashDetails" spacing="15" styleClass="detail-section"
                  visible="false" managed="false">
                <Label text="Pago en Efectivo" styleClass="section-title"/>

                <VBox spacing="10" styleClass="warning-box">
                    <Label fx:id="lblCashInstructions"
                           text="El pago se realizará en efectivo al momento de la entrega. Tenga listo el monto exacto."
                           styleClass="warning-item" wrapText="true"/>
                </VBox>
            </VBox>

            <Separator/>

            <!-- Payment Status -->
            <VBox spacing="10" alignment="CENTER">
                <ProgressIndicator fx:id="progressPayment" visible="false" prefWidth="60" prefHeight="60"/>
                <Label fx:id="lblPaymentStatus" text="" styleClass="detail-value"/>
            </VBox>

            <!-- Action Buttons -->
            <HBox spacing="15" alignment="CENTER_RIGHT">
                <padding>
                    <Insets top="10"/>
                </padding>

                <Button text="Cancelar" onAction="#handleCancel" styleClass="btn-secondary"
                        prefWidth="150" prefHeight="40"/>
                <Button text="Procesar Pago" onAction="#handleProcessPayment"
                        styleClass="btn-success" prefWidth="180" prefHeight="40"/>
            </HBox>

        </VBox>
    </ScrollPane>

</AnchorPane>
