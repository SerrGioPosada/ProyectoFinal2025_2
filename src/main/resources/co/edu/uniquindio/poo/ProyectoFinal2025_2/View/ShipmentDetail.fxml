<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<VBox xmlns="http://javafx.com/javafx" xmlns:fx="http://javafx.com/fxml"
      fx:controller="co.edu.uniquindio.poo.ProyectoFinal2025_2.Controller.ShipmentDetailController"
      spacing="15" styleClass="content-area">

    <padding>
        <Insets top="20" right="20" bottom="20" left="20"/>
    </padding>

    <!-- Header Section -->
    <HBox alignment="CENTER_LEFT" spacing="15" styleClass="header-section">
        <Label text="Detalles del Envío" styleClass="page-title"/>
        <Region HBox.hgrow="ALWAYS"/>
        <Button text="Ver Desglose Detallado" styleClass="btn-primary" onAction="#handleShowDetailedBreakdown"/>
        <Button text="Imprimir" styleClass="btn-secondary" onAction="#handlePrint"/>
        <Button text="Volver" styleClass="btn-secondary" onAction="#handleBack"/>
    </HBox>

    <!-- Scrollable Content -->
    <ScrollPane fitToWidth="true" styleClass="details-scroll" VBox.vgrow="ALWAYS">
        <VBox spacing="20" styleClass="details-container">

            <!-- General Information -->
            <VBox spacing="10" styleClass="detail-section">
                <Label text="Información General" styleClass="section-title"/>
                <GridPane hgap="20" vgap="10" styleClass="detail-grid">
                    <columnConstraints>
                        <ColumnConstraints minWidth="180" prefWidth="200"/>
                        <ColumnConstraints minWidth="300" prefWidth="400"/>
                    </columnConstraints>

                    <Label text="ID de Envío:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                    <Label fx:id="lblId" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                    <Label text="Estado:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                    <Label fx:id="lblStatus" text="--" styleClass="detail-value status-badge" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                    <Label text="Prioridad:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                    <Label fx:id="lblPriority" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="2"/>

                    <Label text="Fecha de Creación:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="3"/>
                    <Label fx:id="lblCreationDate" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="3"/>

                    <Label text="Entrega Estimada:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="4"/>
                    <Label fx:id="lblEstimatedDate" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="4"/>

                    <Label text="Entrega Real:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="5"/>
                    <Label fx:id="lblActualDate" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="5"/>
                </GridPane>
            </VBox>

            <Separator/>

            <!-- User Information -->
            <VBox spacing="10" styleClass="detail-section">
                <Label text="Información del Usuario" styleClass="section-title"/>
                <GridPane hgap="20" vgap="10" styleClass="detail-grid">
                    <columnConstraints>
                        <ColumnConstraints minWidth="180" prefWidth="200"/>
                        <ColumnConstraints minWidth="300" prefWidth="400"/>
                    </columnConstraints>

                    <Label text="Nombre:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                    <Label fx:id="lblUserName" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                    <Label text="Teléfono:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                    <Label fx:id="lblUserPhone" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                    <Label text="Correo:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                    <Label fx:id="lblUserEmail" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="2"/>
                </GridPane>
            </VBox>

            <Separator/>

            <!-- Addresses -->
            <VBox spacing="15">
                <VBox spacing="10" styleClass="detail-section">
                    <Label text="Dirección de Origen" styleClass="section-title"/>
                    <Label fx:id="lblOriginAddress" text="--" styleClass="address-text" wrapText="true"/>
                    <Label fx:id="lblOriginZone" text="Zona: --" styleClass="detail-value"/>
                </VBox>

                <VBox spacing="10" styleClass="detail-section">
                    <Label text="Dirección de Destino" styleClass="section-title"/>
                    <Label fx:id="lblDestinationAddress" text="--" styleClass="address-text" wrapText="true"/>
                    <Label fx:id="lblDestinationZone" text="Zona: --" styleClass="detail-value"/>
                </VBox>
            </VBox>

            <Separator/>

            <!-- Package Details -->
            <VBox spacing="10" styleClass="detail-section">
                <Label text="Detalles del Paquete" styleClass="section-title"/>
                <GridPane hgap="20" vgap="10" styleClass="detail-grid">
                    <columnConstraints>
                        <ColumnConstraints minWidth="180" prefWidth="200"/>
                        <ColumnConstraints minWidth="300" prefWidth="400"/>
                    </columnConstraints>

                    <Label text="Peso:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                    <Label fx:id="lblWeight" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                    <Label text="Volumen:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                    <Label fx:id="lblVolume" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                    <Label text="Dimensiones:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                    <Label fx:id="lblDimensions" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="2"/>

                    <Label text="Distancia:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="3"/>
                    <Label fx:id="lblDistance" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="3"/>
                </GridPane>
            </VBox>

            <Separator/>

            <!-- Delivery Person (if assigned) -->
            <VBox fx:id="deliveryPersonSection" spacing="10" styleClass="detail-section">
                <Label text="Repartidor" styleClass="section-title"/>
                <GridPane hgap="20" vgap="10" styleClass="detail-grid">
                    <columnConstraints>
                        <ColumnConstraints minWidth="180" prefWidth="200"/>
                        <ColumnConstraints minWidth="300" prefWidth="400"/>
                    </columnConstraints>

                    <Label text="Nombre:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                    <Label fx:id="lblDeliveryPersonName" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                    <Label text="Teléfono:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                    <Label fx:id="lblDeliveryPersonPhone" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                    <Label text="Zona:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                    <Label fx:id="lblDeliveryPersonZone" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="2"/>

                    <Label text="Fecha de Asignación:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="3"/>
                    <Label fx:id="lblAssignmentDate" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="3"/>
                </GridPane>
            </VBox>

            <Separator/>

            <!-- Cost Breakdown -->
            <VBox spacing="10" styleClass="detail-section">
                <Label text="Desglose de Costos" styleClass="section-title"/>
                <GridPane hgap="20" vgap="10" styleClass="detail-grid">
                    <columnConstraints>
                        <ColumnConstraints minWidth="180" prefWidth="200"/>
                        <ColumnConstraints minWidth="300" prefWidth="400"/>
                    </columnConstraints>

                    <Label text="Costo Base:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                    <Label fx:id="lblBaseCost" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                    <Label text="Costo de Servicios:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                    <Label fx:id="lblServicesCost" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                    <Label text="Costo Total:" styleClass="detail-label total-label" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                    <Label fx:id="lblTotalCost" text="--" styleClass="detail-value total-value" GridPane.columnIndex="1" GridPane.rowIndex="2"/>
                </GridPane>
            </VBox>

            <Separator/>

            <!-- Additional Services -->
            <VBox spacing="10" styleClass="detail-section">
                <Label text="Servicios Adicionales" styleClass="section-title"/>
                <ListView fx:id="listServices" styleClass="services-list" prefHeight="100"/>
            </VBox>

            <Separator/>

            <!-- Status History -->
            <VBox spacing="10" styleClass="detail-section">
                <Label text="Historial de Estados" styleClass="section-title"/>
                <TableView fx:id="statusHistoryTable" styleClass="history-table" prefHeight="150">
                    <columns>
                        <TableColumn fx:id="colPreviousStatus" text="De" prefWidth="120"/>
                        <TableColumn fx:id="colNewStatus" text="A" prefWidth="120"/>
                        <TableColumn fx:id="colTimestamp" text="Fecha/Hora" prefWidth="150"/>
                        <TableColumn fx:id="colChangedBy" text="Cambiado Por" prefWidth="120"/>
                        <TableColumn fx:id="colReason" text="Razón" prefWidth="200"/>
                    </columns>
                    <placeholder>
                        <Label text="No hay cambios de estado registrados"/>
                    </placeholder>
                </TableView>
            </VBox>

            <Separator/>

            <!-- Notes -->
            <HBox spacing="20">
                <VBox spacing="10" styleClass="detail-section" HBox.hgrow="ALWAYS">
                    <Label text="Notas del Usuario" styleClass="section-title"/>
                    <TextArea fx:id="txtUserNotes" styleClass="notes-area" prefHeight="80" wrapText="true" editable="false"/>
                </VBox>

                <VBox spacing="10" styleClass="detail-section" HBox.hgrow="ALWAYS">
                    <Label text="Notas Internas" styleClass="section-title"/>
                    <TextArea fx:id="txtInternalNotes" styleClass="notes-area" prefHeight="80" wrapText="true" editable="false"/>
                </VBox>
            </HBox>

            <!-- Incident Section (if exists) -->
            <VBox fx:id="incidentSection" spacing="10" styleClass="detail-section incident-section">
                <Label text="Información de Incidente" styleClass="section-title incident-title"/>
                <GridPane hgap="20" vgap="10" styleClass="detail-grid">
                    <columnConstraints>
                        <ColumnConstraints minWidth="150" prefWidth="150"/>
                        <ColumnConstraints minWidth="500" prefWidth="550"/>
                    </columnConstraints>

                    <Label text="Tipo:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                    <Label fx:id="lblIncidentType" text="--" styleClass="detail-value incident-value" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                    <Label text="Fecha:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                    <Label fx:id="lblIncidentDate" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                    <Label text="Descripción:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                    <Label fx:id="lblIncidentDescription" text="--" styleClass="detail-value" wrapText="true" GridPane.columnIndex="1" GridPane.rowIndex="2"/>
                </GridPane>
            </VBox>

        </VBox>
    </ScrollPane>

</VBox>
