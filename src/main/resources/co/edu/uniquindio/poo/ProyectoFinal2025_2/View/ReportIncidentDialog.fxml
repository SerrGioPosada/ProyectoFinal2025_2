<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<VBox xmlns="http://javafx.com/javafx/21"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="co.edu.uniquindio.poo.ProyectoFinal2025_2.Controller.ReportIncidentDialogController"
      spacing="20"
      styleClass="root-pane"
      stylesheets="@../Style.css"
      prefWidth="600"
      prefHeight="550">

    <padding>
        <Insets top="25" right="25" bottom="25" left="25"/>
    </padding>

    <!-- Header Section -->
    <VBox spacing="10">
        <HBox alignment="CENTER_LEFT" spacing="10">
            <Label text="⚠️" style="-fx-font-size: 32px;"/>
            <VBox spacing="3" HBox.hgrow="ALWAYS">
                <Label text="Reportar Incidencia" styleClass="page-title"/>
                <Label text="Describe el problema encontrado durante la entrega" styleClass="info-label"
                       style="-fx-text-fill: #6c757d; -fx-font-size: 13px;"/>
            </VBox>
        </HBox>
        <Separator styleClass="divider"/>
    </VBox>

    <!-- Order Information Section -->
    <VBox styleClass="info-card" spacing="10">
        <padding>
            <Insets top="15" right="15" bottom="15" left="15"/>
        </padding>
        <Label text="Información del Envío" styleClass="card-title"/>
        <GridPane hgap="15" vgap="10">
            <columnConstraints>
                <ColumnConstraints percentWidth="30"/>
                <ColumnConstraints percentWidth="70"/>
            </columnConstraints>

            <Label text="ID Orden:" styleClass="info-label" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
            <Label fx:id="lblOrderId" text="--" styleClass="info-value" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

            <Label text="Dirección:" styleClass="info-label" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
            <Label fx:id="lblAddress" text="--" styleClass="info-value" wrapText="true"
                   GridPane.columnIndex="1" GridPane.rowIndex="1"/>
        </GridPane>
    </VBox>

    <!-- Incident Form Section -->
    <VBox spacing="15" VBox.vgrow="ALWAYS">
        <!-- Incident Type Selection -->
        <VBox spacing="8">
            <Label text="Tipo de Incidencia *" styleClass="form-label"/>
            <ComboBox fx:id="cmbIncidentType" prefWidth="Infinity" styleClass="form-combo" maxWidth="Infinity"
                      promptText="Selecciona el tipo de incidencia"/>
        </VBox>

        <!-- Description TextArea -->
        <VBox spacing="8" VBox.vgrow="ALWAYS">
            <Label text="Descripción Detallada *" styleClass="form-label"/>
            <TextArea fx:id="txtDescription"
                      promptText="Describe detalladamente qué sucedió..."
                      wrapText="true"
                      prefRowCount="6"
                      styleClass="form-field"
                      VBox.vgrow="ALWAYS"/>
            <Label fx:id="lblCharCount" text="0/500 caracteres"
                   style="-fx-text-fill: #6c757d; -fx-font-size: 11px;"/>
        </VBox>

        <!-- Additional Options -->
        <VBox spacing="10">
            <CheckBox fx:id="chkContactCustomer" text="El cliente fue contactado"
                      styleClass="form-checkbox"/>
            <CheckBox fx:id="chkAttachPhoto" text="Se adjuntaron fotos como evidencia"
                      styleClass="form-checkbox"/>
            <CheckBox fx:id="chkRequiresFollowUp" text="Requiere seguimiento posterior"
                      styleClass="form-checkbox"/>
        </VBox>
    </VBox>

    <!-- Warning Info -->
    <HBox spacing="10" alignment="CENTER_LEFT"
          style="-fx-background-color: #e7f3ff; -fx-padding: 12; -fx-background-radius: 8; -fx-border-color: #b3d9ff; -fx-border-radius: 8; -fx-border-width: 1;">
        <Label text="ℹ️" style="-fx-font-size: 18px;"/>
        <VBox spacing="3" HBox.hgrow="ALWAYS">
            <Label text="Nota Importante" style="-fx-font-weight: bold; -fx-text-fill: #004085;"/>
            <Label text="Al reportar una incidencia, se notificará al cliente y quedará registrado en el historial del envío. El estado del envío NO cambiará automáticamente."
                   wrapText="true" style="-fx-text-fill: #004085; -fx-font-size: 12px;"/>
        </VBox>
    </HBox>

    <!-- Action Buttons -->
    <HBox spacing="15" alignment="CENTER_RIGHT">
        <Button text="Cancelar" onAction="#handleCancel"
                styleClass="btn-secondary"
                prefWidth="120"/>
        <Button text="Reportar Incidencia" onAction="#handleSubmit"
                styleClass="btn-primary"
                prefWidth="170"/>
    </HBox>

</VBox>
