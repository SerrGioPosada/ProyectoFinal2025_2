<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane styleClass="content-area"
            xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="co.edu.uniquindio.poo.ProyectoFinal2025_2.Controller.CreateShipmentWizardController">

    <!-- Top Section: Header + Step Indicator (FIXED - NO SCROLL) -->
    <top>
        <VBox spacing="12" styleClass="card-base">
            <padding>
                <Insets top="0" right="20" bottom="12" left="20"/>
            </padding>

            <!-- Header -->
            <HBox alignment="CENTER" spacing="15" style="-fx-padding: 15 0 8 0;">
                <Label text="Crear Nuevo EnvÃ­o" styleClass="page-title" style="-fx-font-size: 22px;"/>
            </HBox>

            <!-- Step Indicator -->
            <HBox alignment="CENTER" spacing="20" fx:id="stepIndicatorContainer">
                <padding>
                    <Insets top="5" right="0" bottom="0" left="0"/>
                </padding>

                <!-- Step 1 -->
                <VBox alignment="CENTER" spacing="6" fx:id="step1Container">
                    <StackPane styleClass="step-circle-active" minWidth="50" minHeight="50"
                               prefWidth="50" prefHeight="50" maxWidth="50" maxHeight="50">
                        <Label text="1" styleClass="step-number" style="-fx-font-size: 18px;"/>
                    </StackPane>
                    <Label text="Paquete" styleClass="step-label" style="-fx-font-size: 11px;"/>
                </VBox>

                <Separator prefWidth="40" styleClass="divider"/>

                <!-- Step 2 -->
                <VBox alignment="CENTER" spacing="6" fx:id="step2Container" opacity="0.5">
                    <StackPane styleClass="step-circle-inactive" minWidth="50" minHeight="50"
                               prefWidth="50" prefHeight="50" maxWidth="50" maxHeight="50">
                        <Label text="2" styleClass="step-number" style="-fx-font-size: 18px;"/>
                    </StackPane>
                    <Label text="Origen" styleClass="step-label" style="-fx-font-size: 11px;"/>
                </VBox>

                <Separator prefWidth="40" styleClass="divider"/>

                <!-- Step 3 -->
                <VBox alignment="CENTER" spacing="6" fx:id="step3Container" opacity="0.5">
                    <StackPane styleClass="step-circle-inactive" minWidth="50" minHeight="50"
                               prefWidth="50" prefHeight="50" maxWidth="50" maxHeight="50">
                        <Label text="3" styleClass="step-number" style="-fx-font-size: 18px;"/>
                    </StackPane>
                    <Label text="Destino" styleClass="step-label" style="-fx-font-size: 11px;"/>
                </VBox>

                <Separator prefWidth="40" styleClass="divider"/>

                <!-- Step 4 -->
                <VBox alignment="CENTER" spacing="6" fx:id="step4Container" opacity="0.5">
                    <StackPane styleClass="step-circle-inactive" minWidth="50" minHeight="50"
                               prefWidth="50" prefHeight="50" maxWidth="50" maxHeight="50">
                        <Label text="4" styleClass="step-number" style="-fx-font-size: 18px;"/>
                    </StackPane>
                    <Label text="Servicios" styleClass="step-label" style="-fx-font-size: 11px;"/>
                </VBox>

                <Separator prefWidth="40" styleClass="divider"/>

                <!-- Step 5 -->
                <VBox alignment="CENTER" spacing="6" fx:id="step5Container" opacity="0.5">
                    <StackPane styleClass="step-circle-inactive" minWidth="50" minHeight="50"
                               prefWidth="50" prefHeight="50" maxWidth="50" maxHeight="50">
                        <Label text="5" styleClass="step-number" style="-fx-font-size: 18px;"/>
                    </StackPane>
                    <Label text="Resumen" styleClass="step-label" style="-fx-font-size: 11px;"/>
                </VBox>
            </HBox>
        </VBox>
    </top>

    <!-- Center Section: Form Content (SCROLLABLE) -->
    <center>
        <ScrollPane fitToWidth="true" styleClass="details-scroll" pannable="true">
            <HBox alignment="TOP_CENTER" fillHeight="false">
                <padding>
                    <Insets top="15" right="20" bottom="15" left="20"/>
                </padding>
                <VBox spacing="20" styleClass="card-base" maxWidth="900">
                    <padding>
                        <Insets top="25" right="30" bottom="25" left="30"/>
                    </padding>

                <!-- PASO 1: Datos del Paquete -->
                <VBox spacing="12" fx:id="step1Form">
                    <Label text="Paso 1: Datos del Paquete" styleClass="section-title"/>
                    <Label text="Ingresa las dimensiones y peso del paquete" styleClass="text-muted"/>

                    <GridPane hgap="20" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="50"/>
                            <ColumnConstraints percentWidth="50"/>
                        </columnConstraints>

                        <!-- Peso -->
                        <VBox spacing="3" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <Label fx:id="lblWeightFloat" text="PESO (KG)" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtWeight" promptText="PESO (KG)" styleClass="modern-input-light"/>
                            </StackPane>
                            <Label fx:id="lblWeightError" styleClass="error-message" visible="false" managed="false"/>
                        </VBox>

                        <!-- Alto -->
                        <VBox spacing="3" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <Label fx:id="lblHeightFloat" text="ALTO (CM)" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtHeight" promptText="ALTO (CM)" styleClass="modern-input-light"/>
                            </StackPane>
                            <Label fx:id="lblHeightError" styleClass="error-message" visible="false" managed="false"/>
                        </VBox>

                        <!-- Ancho -->
                        <VBox spacing="3" GridPane.columnIndex="0" GridPane.rowIndex="1">
                            <Label fx:id="lblWidthFloat" text="ANCHO (CM)" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtWidth" promptText="ANCHO (CM)" styleClass="modern-input-light"/>
                            </StackPane>
                            <Label fx:id="lblWidthError" styleClass="error-message" visible="false" managed="false"/>
                        </VBox>

                        <!-- Largo -->
                        <VBox spacing="3" GridPane.columnIndex="1" GridPane.rowIndex="1">
                            <Label fx:id="lblLengthFloat" text="LARGO (CM)" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtLength" promptText="LARGO (CM)" styleClass="modern-input-light"/>
                            </StackPane>
                            <Label fx:id="lblLengthError" styleClass="error-message" visible="false" managed="false"/>
                        </VBox>

                        <!-- Volumen (calculado) -->
                        <VBox spacing="8" GridPane.columnIndex="0" GridPane.rowIndex="2" GridPane.columnSpan="2">
                            <Label text="Volumen Calculado" styleClass="form-label"/>
                            <Label fx:id="lblVolumeCalculated" text="0.0 mÂ³" styleClass="detail-value"
                                   style="-fx-font-size: 18px; -fx-text-fill: #4a9eff;"/>
                        </VBox>
                    </GridPane>
                </VBox>

                <!-- PASO 2: DirecciÃ³n de Origen -->
                <VBox spacing="20" fx:id="step2Form" visible="false" managed="false">
                    <Label text="Paso 2: DirecciÃ³n de Origen" styleClass="section-title"/>
                    <Label text="Ingresa la direcciÃ³n donde recogeremos el paquete" styleClass="text-muted"/>

                    <!-- Seleccionar direcciÃ³n guardada -->
                    <VBox spacing="8">
                        <Label text="Direcciones Guardadas (Opcional)" styleClass="form-label"/>
                        <ComboBox fx:id="cmbOriginSavedAddresses" promptText="Selecciona una direcciÃ³n guardada o ingresa manualmente"
                                  styleClass="form-combo" maxWidth="Infinity"/>
                    </VBox>

                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="33.33"/>
                            <ColumnConstraints percentWidth="33.33"/>
                            <ColumnConstraints percentWidth="33.33"/>
                        </columnConstraints>

                        <!-- Alias -->
                        <VBox spacing="3" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <Label fx:id="lblOriginAliasFloat" text="ALIAS (OPCIONAL)" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtOriginAlias" promptText="ALIAS (OPCIONAL)" styleClass="modern-input-light"/>
                            </StackPane>
                        </VBox>

                        <!-- Calle -->
                        <VBox spacing="3" GridPane.columnIndex="1" GridPane.rowIndex="0" GridPane.columnSpan="2">
                            <Label fx:id="lblOriginStreetFloat" text="CALLE / DIRECCIÃ“N" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtOriginStreet" promptText="CALLE / DIRECCIÃ“N" styleClass="modern-input-light"/>
                            </StackPane>
                            <Label fx:id="lblOriginStreetError" styleClass="error-message" visible="false" managed="false"/>
                        </VBox>

                        <!-- Ciudad -->
                        <VBox spacing="3" GridPane.columnIndex="0" GridPane.rowIndex="1">
                            <Label fx:id="lblOriginCityFloat" text="CIUDAD" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtOriginCity" promptText="CIUDAD" styleClass="modern-input-light"/>
                            </StackPane>
                            <Label fx:id="lblOriginCityError" styleClass="error-message" visible="false" managed="false"/>
                        </VBox>

                        <!-- Departamento -->
                        <VBox spacing="3" GridPane.columnIndex="1" GridPane.rowIndex="1">
                            <Label fx:id="lblOriginStateFloat" text="DEPARTAMENTO" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtOriginState" promptText="DEPARTAMENTO" styleClass="modern-input-light"/>
                            </StackPane>
                        </VBox>

                        <!-- CÃ³digo Postal -->
                        <VBox spacing="3" GridPane.columnIndex="2" GridPane.rowIndex="1">
                            <Label fx:id="lblOriginZipCodeFloat" text="CÃ“DIGO POSTAL" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtOriginZipCode" promptText="CÃ“DIGO POSTAL" styleClass="modern-input-light"/>
                            </StackPane>
                        </VBox>

                        <!-- PaÃ­s -->
                        <VBox spacing="3" GridPane.columnIndex="0" GridPane.rowIndex="2">
                            <Label fx:id="lblOriginCountryFloat" text="PAÃS" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtOriginCountry" promptText="PAÃS" text="Colombia" styleClass="modern-input-light"/>
                            </StackPane>
                        </VBox>

                        <!-- Coordenadas (Opcionales - para mapa futuro) -->
                        <VBox spacing="3" GridPane.columnIndex="1" GridPane.rowIndex="2">
                            <Label fx:id="lblOriginLatitudeFloat" text="LATITUD (OPCIONAL)" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtOriginLatitude" promptText="LATITUD (OPCIONAL)" styleClass="modern-input-light"/>
                            </StackPane>
                        </VBox>

                        <VBox spacing="3" GridPane.columnIndex="2" GridPane.rowIndex="2">
                            <Label fx:id="lblOriginLongitudeFloat" text="LONGITUD (OPCIONAL)" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtOriginLongitude" promptText="LONGITUD (OPCIONAL)" styleClass="modern-input-light"/>
                            </StackPane>
                        </VBox>
                    </GridPane>
                </VBox>

                <!-- PASO 3: DirecciÃ³n de Destino -->
                <VBox spacing="20" fx:id="step3Form" visible="false" managed="false">
                    <Label text="Paso 3: DirecciÃ³n de Destino" styleClass="section-title"/>
                    <Label text="Ingresa la direcciÃ³n donde entregaremos el paquete" styleClass="text-muted"/>

                    <!-- Seleccionar direcciÃ³n guardada -->
                    <VBox spacing="8">
                        <Label text="Direcciones Guardadas (Opcional)" styleClass="form-label"/>
                        <ComboBox fx:id="cmbDestinationSavedAddresses" promptText="Selecciona una direcciÃ³n guardada o ingresa manualmente"
                                  styleClass="form-combo" maxWidth="Infinity"/>
                    </VBox>

                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="33.33"/>
                            <ColumnConstraints percentWidth="33.33"/>
                            <ColumnConstraints percentWidth="33.33"/>
                        </columnConstraints>

                        <!-- Alias -->
                        <VBox spacing="3" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <Label fx:id="lblDestinationAliasFloat" text="ALIAS (OPCIONAL)" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtDestinationAlias" promptText="ALIAS (OPCIONAL)" styleClass="modern-input-light"/>
                            </StackPane>
                        </VBox>

                        <!-- Calle -->
                        <VBox spacing="3" GridPane.columnIndex="1" GridPane.rowIndex="0" GridPane.columnSpan="2">
                            <Label fx:id="lblDestinationStreetFloat" text="CALLE / DIRECCIÃ“N" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtDestinationStreet" promptText="CALLE / DIRECCIÃ“N" styleClass="modern-input-light"/>
                            </StackPane>
                            <Label fx:id="lblDestinationStreetError" styleClass="error-message" visible="false" managed="false"/>
                        </VBox>

                        <!-- Ciudad -->
                        <VBox spacing="3" GridPane.columnIndex="0" GridPane.rowIndex="1">
                            <Label fx:id="lblDestinationCityFloat" text="CIUDAD" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtDestinationCity" promptText="CIUDAD" styleClass="modern-input-light"/>
                            </StackPane>
                            <Label fx:id="lblDestinationCityError" styleClass="error-message" visible="false" managed="false"/>
                        </VBox>

                        <!-- Departamento -->
                        <VBox spacing="3" GridPane.columnIndex="1" GridPane.rowIndex="1">
                            <Label fx:id="lblDestinationStateFloat" text="DEPARTAMENTO" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtDestinationState" promptText="DEPARTAMENTO" styleClass="modern-input-light"/>
                            </StackPane>
                        </VBox>

                        <!-- CÃ³digo Postal -->
                        <VBox spacing="3" GridPane.columnIndex="2" GridPane.rowIndex="1">
                            <Label fx:id="lblDestinationZipCodeFloat" text="CÃ“DIGO POSTAL" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtDestinationZipCode" promptText="CÃ“DIGO POSTAL" styleClass="modern-input-light"/>
                            </StackPane>
                        </VBox>

                        <!-- PaÃ­s -->
                        <VBox spacing="3" GridPane.columnIndex="0" GridPane.rowIndex="2">
                            <Label fx:id="lblDestinationCountryFloat" text="PAÃS" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtDestinationCountry" promptText="PAÃS" text="Colombia" styleClass="modern-input-light"/>
                            </StackPane>
                        </VBox>

                        <!-- Coordenadas (Opcionales - para mapa futuro) -->
                        <VBox spacing="3" GridPane.columnIndex="1" GridPane.rowIndex="2">
                            <Label fx:id="lblDestinationLatitudeFloat" text="LATITUD (OPCIONAL)" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtDestinationLatitude" promptText="LATITUD (OPCIONAL)" styleClass="modern-input-light"/>
                            </StackPane>
                        </VBox>

                        <VBox spacing="3" GridPane.columnIndex="2" GridPane.rowIndex="2">
                            <Label fx:id="lblDestinationLongitudeFloat" text="LONGITUD (OPCIONAL)" styleClass="floating-label-light"/>
                            <StackPane styleClass="input-container">
                                <TextField fx:id="txtDestinationLongitude" promptText="LONGITUD (OPCIONAL)" styleClass="modern-input-light"/>
                            </StackPane>
                        </VBox>
                    </GridPane>
                </VBox>

                <!-- PASO 4: Servicios Adicionales -->
                <VBox spacing="15" fx:id="step4Form" visible="false" managed="false">
                    <Label text="Paso 4: Servicios Adicionales" styleClass="section-title"/>
                    <Label text="Selecciona los servicios adicionales para tu envÃ­o" styleClass="text-muted"/>

                    <!-- Main Horizontal Layout: Services Left, Other Blocks Right -->
                    <HBox spacing="20" alignment="TOP_LEFT" VBox.vgrow="ALWAYS">
                        <!-- LEFT: Services Block -->
                        <VBox spacing="12" HBox.hgrow="ALWAYS">
                            <Label text="Servicios" styleClass="form-label" style="-fx-font-weight: bold; -fx-font-size: 14px;"/>

                            <!-- Seguro -->
                            <HBox spacing="12" alignment="CENTER_LEFT" styleClass="service-card">
                                <padding>
                                    <Insets top="12" right="12" bottom="12" left="12"/>
                                </padding>
                                <CheckBox fx:id="chkInsurance" styleClass="service-checkbox"/>
                                <VBox spacing="3" HBox.hgrow="ALWAYS">
                                    <Label text="Seguro de EnvÃ­o" styleClass="form-label" style="-fx-font-weight: bold;"/>
                                    <Label text="Protege tu paquete contra pÃ©rdidas o daÃ±os (5%)" styleClass="form-label-small"/>
                                </VBox>
                                <Label fx:id="lblInsuranceCost" text="0" styleClass="detail-value" style="-fx-font-size: 14px;"/>
                            </HBox>

                            <!-- FrÃ¡gil -->
                            <HBox spacing="12" alignment="CENTER_LEFT" styleClass="service-card">
                                <padding>
                                    <Insets top="12" right="12" bottom="12" left="12"/>
                                </padding>
                                <CheckBox fx:id="chkFragile" styleClass="service-checkbox"/>
                                <VBox spacing="3" HBox.hgrow="ALWAYS">
                                    <Label text="Manejo FrÃ¡gil" styleClass="form-label" style="-fx-font-weight: bold;"/>
                                    <Label text="Manejo especial para paquetes delicados" styleClass="form-label-small"/>
                                </VBox>
                                <Label text="2,000" styleClass="detail-value" style="-fx-font-size: 14px;"/>
                            </HBox>

                            <!-- Firma Requerida -->
                            <HBox spacing="12" alignment="CENTER_LEFT" styleClass="service-card">
                                <padding>
                                    <Insets top="12" right="12" bottom="12" left="12"/>
                                </padding>
                                <CheckBox fx:id="chkSignature" styleClass="service-checkbox"/>
                                <VBox spacing="3" HBox.hgrow="ALWAYS">
                                    <Label text="Firma Requerida" styleClass="form-label" style="-fx-font-weight: bold;"/>
                                    <Label text="Requiere firma del destinatario" styleClass="form-label-small"/>
                                </VBox>
                                <Label text="1,500" styleClass="detail-value" style="-fx-font-size: 14px;"/>
                            </HBox>

                            <!-- Prioridad -->
                            <HBox spacing="12" alignment="CENTER_LEFT" styleClass="service-card">
                                <padding>
                                    <Insets top="12" right="12" bottom="12" left="12"/>
                                </padding>
                                <CheckBox fx:id="chkPriority" styleClass="service-checkbox"/>
                                <VBox spacing="3" HBox.hgrow="ALWAYS">
                                    <Label text="Entrega Prioritaria" styleClass="form-label" style="-fx-font-weight: bold;"/>
                                    <Label text="Entrega mÃ¡s rÃ¡pida (15% adicional)" styleClass="form-label-small"/>
                                </VBox>
                                <Label fx:id="lblPriorityCost" text="0" styleClass="detail-value" style="-fx-font-size: 14px;"/>
                            </HBox>
                        </VBox>

                        <!-- RIGHT: Other Blocks Stacked Vertically -->
                        <VBox spacing="15" HBox.hgrow="ALWAYS">
                            <!-- Vehicle Selection -->
                            <VBox spacing="10" styleClass="card-base">
                                <padding>
                                    <Insets top="12" right="12" bottom="12" left="12"/>
                                </padding>
                                <Label text="ðŸš— SelecciÃ³n de VehÃ­culo" styleClass="form-label" style="-fx-font-weight: bold; -fx-font-size: 13px;"/>
                                <Label fx:id="lblVehicleRecommendation" text="" styleClass="text-muted" wrapText="true" style="-fx-font-size: 11px;"/>

                                <HBox spacing="12" alignment="CENTER_LEFT">
                                    <Label text="Tipo:" styleClass="form-label"/>
                                    <ComboBox fx:id="cmbVehicleType" promptText="Seleccione vehÃ­culo" prefWidth="200" styleClass="form-input" HBox.hgrow="ALWAYS"/>
                                </HBox>

                                <Label fx:id="lblVehicleValidation" text="" wrapText="true" style="-fx-text-fill: #d9534f; -fx-font-weight: bold; -fx-font-size: 11px;"/>
                            </VBox>

                            <!-- Fecha de recogida -->
                            <VBox spacing="8" styleClass="card-base">
                                <padding>
                                    <Insets top="12" right="12" bottom="12" left="12"/>
                                </padding>
                                <Label text="Fecha y Hora de Recogida" styleClass="form-label" style="-fx-font-weight: bold; -fx-font-size: 13px;"/>
                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <VBox spacing="3" HBox.hgrow="ALWAYS">
                                        <Label text="Fecha" styleClass="form-label-small"/>
                                        <DatePicker fx:id="datePickup" promptText="Selecciona fecha" styleClass="form-input"/>
                                    </VBox>
                                    <VBox spacing="3">
                                        <Label text="Hora" styleClass="form-label-small"/>
                                        <Spinner fx:id="spinnerHour" editable="true" prefWidth="60"
                                                 styleClass="time-spinner"/>
                                    </VBox>
                                    <Label text=":" style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-padding: 15 3 0 3;"/>
                                    <VBox spacing="3">
                                        <Label text="Min" styleClass="form-label-small"/>
                                        <Spinner fx:id="spinnerMinute" editable="true" prefWidth="60"
                                                 styleClass="time-spinner"/>
                                    </VBox>
                                </HBox>
                            </VBox>
                        </VBox>
                    </HBox>

                    <!-- Notas adicionales - Full Width at Bottom -->
                    <VBox spacing="8" styleClass="card-base">
                        <padding>
                            <Insets top="12" right="12" bottom="12" left="12"/>
                        </padding>
                        <Label text="Notas Adicionales (Opcional)" styleClass="form-label" style="-fx-font-weight: bold; -fx-font-size: 13px;"/>
                        <TextArea fx:id="txtNotes" promptText="Instrucciones especiales para la entrega..."
                                 styleClass="form-input" wrapText="true" prefHeight="70"/>
                    </VBox>
                </VBox>

                <!-- PASO 5: Resumen y CotizaciÃ³n -->
                <VBox spacing="15" fx:id="step5Form" visible="false" managed="false">
                    <Label text="ðŸ“‹ Paso 5: Resumen y CotizaciÃ³n" styleClass="section-title"/>
                    <Label text="Revisa los detalles de tu envÃ­o antes de confirmar" styleClass="text-muted"/>

                    <!-- Main Horizontal Layout: Summary Left, Costs Right -->
                    <HBox spacing="20" alignment="TOP_LEFT" VBox.vgrow="ALWAYS">
                        <!-- LEFT: Summary Blocks -->
                        <VBox spacing="15" HBox.hgrow="ALWAYS">
                            <!-- Resumen del Paquete -->
                            <VBox spacing="10" styleClass="info-card">
                                <padding>
                                    <Insets top="12" right="12" bottom="12" left="12"/>
                                </padding>
                                <Label text="ðŸ“¦ Paquete" styleClass="form-label" style="-fx-font-weight: bold; -fx-font-size: 13px;"/>
                                <GridPane hgap="12" vgap="6">
                                    <columnConstraints>
                                        <ColumnConstraints minWidth="100"/>
                                        <ColumnConstraints/>
                                    </columnConstraints>
                                    <Label text="Peso:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                                    <Label fx:id="lblSummaryWeight" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                                    <Label text="Dimensiones:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                                    <Label fx:id="lblSummaryDimensions" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                                    <Label text="Volumen:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                                    <Label fx:id="lblSummaryVolume" text="--" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="2"/>
                                </GridPane>
                            </VBox>

                            <!-- Origen -->
                            <VBox spacing="8" styleClass="info-card">
                                <padding>
                                    <Insets top="12" right="12" bottom="12" left="12"/>
                                </padding>
                                <Label text="ðŸ“ Origen" styleClass="form-label" style="-fx-font-weight: bold; -fx-font-size: 13px;"/>
                                <Label fx:id="lblSummaryOrigin" text="--" styleClass="detail-value" wrapText="true"/>
                            </VBox>

                            <!-- Destino -->
                            <VBox spacing="8" styleClass="info-card">
                                <padding>
                                    <Insets top="12" right="12" bottom="12" left="12"/>
                                </padding>
                                <Label text="ðŸŽ¯ Destino" styleClass="form-label" style="-fx-font-weight: bold; -fx-font-size: 13px;"/>
                                <Label fx:id="lblSummaryDestination" text="--" styleClass="detail-value" wrapText="true"/>
                            </VBox>

                            <!-- Servicios Seleccionados -->
                            <VBox spacing="8" styleClass="info-card" fx:id="summaryServicesContainer">
                                <padding>
                                    <Insets top="12" right="12" bottom="12" left="12"/>
                                </padding>
                                <Label text="âœ¨ Servicios Adicionales" styleClass="form-label" style="-fx-font-weight: bold; -fx-font-size: 13px;"/>
                                <Label fx:id="lblSummaryServices" text="Ninguno seleccionado" styleClass="detail-value"/>
                            </VBox>
                        </VBox>

                        <!-- RIGHT: Cost Breakdown -->
                        <VBox spacing="15" styleClass="card-base" style="-fx-background-color: linear-gradient(to bottom right, #f8f9fa, #e9ecef);" HBox.hgrow="ALWAYS" prefWidth="400">
                            <padding>
                                <Insets top="20" right="20" bottom="20" left="20"/>
                            </padding>
                            <Label text="ðŸ’° Desglose de Costos" styleClass="section-title" style="-fx-font-size: 15px;"/>

                            <GridPane hgap="12" vgap="10">
                                <columnConstraints>
                                    <ColumnConstraints hgrow="SOMETIMES" halignment="LEFT"/>
                                    <ColumnConstraints hgrow="SOMETIMES" halignment="RIGHT"/>
                                </columnConstraints>

                                <Label text="Costo Base:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                                <Label fx:id="lblQuoteBaseCost" text="0" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                                <Label text="Costo por Distancia:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                                <Label fx:id="lblQuoteDistanceCost" text="0" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                                <Label text="Costo por Peso:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                                <Label fx:id="lblQuoteWeightCost" text="0" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="2"/>

                                <Label text="Costo por Volumen:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="3"/>
                                <Label fx:id="lblQuoteVolumeCost" text="0" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="3"/>

                                <Label text="Servicios Adicionales:" styleClass="detail-label" GridPane.columnIndex="0" GridPane.rowIndex="4"/>
                                <Label fx:id="lblQuoteServicesCost" text="0" styleClass="detail-value" GridPane.columnIndex="1" GridPane.rowIndex="4"/>

                                <Separator GridPane.columnIndex="0" GridPane.rowIndex="5" GridPane.columnSpan="2"/>

                                <Label text="TOTAL:" styleClass="form-label" style="-fx-font-weight: bold; -fx-font-size: 16px;" GridPane.columnIndex="0" GridPane.rowIndex="6"/>
                                <Label fx:id="lblQuoteTotalCost" text="0" styleClass="detail-value" style="-fx-font-size: 22px; -fx-font-weight: bold; -fx-text-fill: #4a9eff;" GridPane.columnIndex="1" GridPane.rowIndex="6"/>
                            </GridPane>

                            <Separator/>

                            <Label fx:id="lblEstimatedDelivery" text="Fecha estimada de entrega: --" styleClass="form-label" style="-fx-font-style: italic; -fx-font-size: 12px;"/>
                        </VBox>
                    </HBox>
                </VBox>
                </VBox>
            </HBox>
        </ScrollPane>
    </center>

    <!-- Bottom Section: Navigation Buttons (FIXED - NO SCROLL) -->
    <bottom>
        <HBox spacing="15" alignment="CENTER" styleClass="card-base">
            <padding>
                <Insets top="12" right="20" bottom="12" left="20"/>
            </padding>
            <Button fx:id="btnPrevious" text="â† Anterior" styleClass="btn-secondary" onAction="#handlePrevious"
                    prefWidth="130" prefHeight="38" visible="false" managed="false"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Button fx:id="btnCancel" text="Cancelar" styleClass="btn-danger" onAction="#handleCancelWizard"
                    prefWidth="120" prefHeight="38"/>
            <Button fx:id="btnNext" text="Siguiente â†’" styleClass="btn-primary" onAction="#handleNext"
                    prefWidth="130" prefHeight="38"/>
            <Button fx:id="btnConfirm" text="Confirmar EnvÃ­o" styleClass="btn-success" onAction="#handleConfirm"
                    prefWidth="160" prefHeight="38" visible="false" managed="false"/>
        </HBox>
    </bottom>
</BorderPane>
